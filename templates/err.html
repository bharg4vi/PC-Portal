<!DOCTYPE html>
<html class="no-js">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>Student</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link href="../static/css/bootstrap.min.css" rel="stylesheet">
        <link rel="stylesheet" href="../static/css/style.css">
        <script src="../static/js/javascript.js"></script>

    </head>
    <style>
        .btn-primary {
    color: #fff;
    background-color: #233a52;
    border-color: #233a52;
}
.resume_1 {
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh; /* This ensures the content is vertically centered in the viewport */
  }
  .col-md-12 {
    text-align: center;
  }
    </style>
<body>
    <div class="resume_1">
        <div class="col-md-12">
            <h4>No data available. Please enter your information.</h4>
            <a style="margin: 20px; color: white !important;" class="btn btn-primary" href="#popup1">Edit your data</a>
        </div>
    </div>


    <div id="popup1" class="overlay">
        <div class="popup">
            <div class="container">
                <div class="row">
                    <div class="col-md-12">
                        <h5>PERSONAL INFORMATION</h5>
                    </div>
                </div>

                <form class="needs-validation" novalidate action="/add_data" method="POST">
                    <div class="form-row form-group">
                        <div class="col-md-4">
                            <label for="name">Full name</label>
                            <input type="text" name="name" class="form-control" id="name" placeholder="Full name" required>
                           <div class="invalid-feedback">Enter your Full name.</div>
                        </div>
                        
                        <div class="col-md-4">
                            <label for="dob">Date Of Birth</label>
                            <input type="date" name="dob" class="form-control" id="dob" placeholder="enter your dob" required>
                            <div class="invalid-feedback"> Enter your date of birth.</div>
                        </div> 
                        <div class="col-md-4">
                            <label for="email">Email Address</label>
                            <input type="text" name="email" class="form-control" id="email" placeholder="enter your email"  required>
                            <div class="invalid-feedback"> Enter your email address.</div>
                        </div> 
                        <div class="col-md-4">
                            <label for="phnum">Phone number</label>
                            <input type="text" name="phnum" class="form-control" id="phnum" placeholder="enter your phone number"  required>
                            <div class="invalid-feedback"> Enter your phone number.</div>
                        </div> 
                        <div class="col-md-4">
                            <label for="city">City</label>
                            <input name="city" type="text" class="form-control" id="city" placeholder="enter your city."  required>
                            <div class="invalid-feedback"> Enter your city.</div>
                        </div>  
                        <div class="col-md-4">
                            <label for="city">State</label>
                            <input name="state" type="text" class="form-control" id="state" placeholder="enter your state."  required>
                            <div class="invalid-feedback"> Enter your state.</div>
                        </div> 
                        <div class="col-md-12">
                            <label for="ucareerob">Career Objective</label>
                            <textarea rows="5" name="ucareerob"  class="form-control" id="ucareerob" placeholder="enter your Career Objectives."  required></textarea>
                            <div class="invalid-feedback"> Enter your career Objective.</div>
                        </div>
                        <div class="col-md-12">
                                <label for="uaboutself">About your Self</label>
                                <textarea name="uaboutself" rows="5"  class="form-control" id="uaboutself" placeholder="enter about your self"  ></textarea>
                                <div class="invalid-feedback"> Enter about you.</div>
                            </div> 
                    </div>
                    <div class="row">
                        <div class="col-md-12">
                            <h5>EDUCATION DETAILS</h5>

                        </div>
                    
                        <div class="col-md-6">
                            <label for="city">Course / Graduation</label>
                            <input name="course" type="text" class="form-control" id="course" placeholder="Enter your course name."  >
                        </div>  
                        <div class="col-md-6">
                            <label for="cpi">CPI</label>
                            <input type="text" name="cpi" class="form-control" id="cpi" placeholder="Enter your CPI.">
                        </div>  
                        
                        <div class="col-md-6">
                            <label for="college">College / Institute</label>
                            <input name="college" type="text" class="form-control" id="college" placeholder="Enter your college name.">
                            <div style="color: red; display: none;" id="col_err">**enter College.</div>
                        </div> 
                        
                        <div class="col-md-4">
                            <label for="city">Graduated Month</label>
                            <select name="graduation_month" class="form-control" id="month"> 
                                <option value="0">Please select One..</option>
                                <option value="January">January</option>
                                <option value="February">February</option>
                                <option value="March">March</option>
                                <option value="April">April</option>
                                <option value="May">May</option>
                                <option value="June">June</option>
                                <option value="July">July</option>
                                <option value="August">August</option>
                                <option value="September">September</option>
                                <option value="October">October</option>
                                <option value="November">November</option>
                                <option value="December">December</option>
                            </select>
                            <div style="color: red; display: none;" id="select_month_err">**select the month.</div>
                        </div> 
                        
                        <div class="col-md-4">
                            <label for="graduation_year">Graduated Year</label>
                            <input name="graduation_year" type="number" min="1990" max="2060" class="form-control" id="year" placeholder="Enter year.">
                        </div> 
                        
                        <div class="col-md-2">
                            <label></label>
                            <input type="submit" value="Add data" style="width: 100%; margin-top: 8px;" class="btn" id="addDataBtn">
                        </div>
                            
                        <div class="col-md-12" style="padding: 20px;">
                            <table id="education_data" style="width: 100%;margin-top: 12px">
                               
                            </table>
                        </div>  
                        
                    </div>
                    <div class="row">
                        <div class="col-md-12">
                                <h5>ACHIEVEMENTS</h5>
                        </div>
                        <div class="col-md-6">
                            <label for="achivement">Achievements</label>
                            <textarea rows="4"  class="form-control" id="achivement" placeholder="enter your achievement.."  ></textarea>
                            <div style="color: red;display: none" id="achivement_err">**enter achievement.</div>
                            <div style="color: rgb(90, 206, 67);display: none" id="achivements">**Entered achievement successfully.</div>
                        </div>  
                        <div class="col-md-3">
                            <label></label>
                            <input type="button" value="Add achievement" style="width: 100%;margin-top: 8px"  class="btn" onclick="addAchievementData()">
                        </div>
                        <div class="col-md-3">
                            <label></label>
                            <input type="button" value="Delete achievement" style="width: 100%;margin-top: 8px"  class="btn" onclick="achivementDeleteFunction()">
                        </div>  
                        <div class="col-md-12" style="padding: 20px;">
                            <table id="acheivement_data" style="width: 100%;margin-top: 12px">
                            </table>
                        </div>  
                    </div>
                    <div class="row">
                        <div class="col-md-12">
                            <h5>SKILLS</h5>
                        </div>
                        <div class="col-md-6">
                            <label for="skills">Skills</label>
                            <textarea rows="4" class="form-control" id="skills" placeholder="Enter your skills"></textarea>
                            <div style="color: red; display: none" id="skills_err">**Enter your skills.</div>
                        </div>
                        <div class="col-md-3">
                            <label></label>
                            <input type="button" value="Add skills" style="width: 100%; margin-top: 8px" class="btn" onclick="addSkills()">
                        </div>
                        <div class="col-md-3">
                            <label></label>
                            <input type="button" value="Delete skills" style="width: 100%; margin-top: 8px" class="btn" onclick="deleteSkills()">
                        </div>
                        <div class="col-md-12" style="padding: 20px;">
                            <table id="skill_data" style="width: 100%; margin-top: 12px">
                            </table>
                        </div>
                        <div class="row">
                            <div class="col-md-12">
                                <h5>PERSONAL DETAILS</h5>
                                <br>
                            </div>     
                        </div>
                        <div class="form-row form-group">
                            <div class="col-md-2">
                                <label for="fname">Father's Name</label>
                                <input name="fname" type="text" class="form-control" id="fname" placeholder="enter your father's name" required>
                                <div class="invalid-feedback"> Enter your Full name.</div>
                            </div>   
                            <div class="col-md-4">
                                <label for="mname">Mother's Name</label>
                                <input name="mname" type="text" class="form-control" id="mname" placeholder="enter your Mother's name" required>
                                <div class="invalid-feedback"> Enter your date of birth.</div>
                            </div> 
                            <div class="col-md-12">
                                <label for="paddress">Permanent Address</label>
                                <textarea name="paddress" rows="4"  class="form-control" id="paddress" placeholder="enter your address.."  required></textarea>
                                <div class="invalid-feedback">**enter address.</div>
                             </div>
                        </div>

                        <div style="margin-bottom: 20px;">
                            <button class="btn btn-primary" type="submit" >Submit form</button>
                            <a href="#" class="btn btn-danger">Cancel</a>
                        </div>
                        </div>

                </form>
            </div>
        </div>
    </div>
   



<script src="../static/jquery-2.1.3.js"></script>
<script src="../static/my.js"></script>
<script src="../static/bootstrap/js/bootstrap.min.js"></script>
<script src="../static/bootstrap/js/bootstrap.bundle.min.js"></script>
<script>
            // Example starter JavaScript for disabling form submissions if there are invalid fields
            (function() {
      'use strict';
      window.addEventListener('load', function() {
        // Fetch all the forms we want to apply custom Bootstrap validation styles to
        var forms = document.getElementsByClassName('needs-validation');
        // Loop over them and prevent submission
        var validation = Array.prototype.filter.call(forms, function(form) {
          form.addEventListener('submit', function(event) {
            if (form.checkValidity() === false) {
              event.preventDefault();
              event.stopPropagation();
            }
            if (form.checkValidity() !== false) {
                setdata();
            }
            form.classList.add('was-validated');
          }, false);
        });
      }, false);
    })();

    function setdata(){
        document.getElementById('uname').innerText = document.getElementById('name').value;
        document.getElementById('name_declaration').innerText = document.getElementById('name').value;
        document.getElementById('n_declaration').innerText = document.getElementById('name').value;

        
        document.getElementById('udob').innerText = document.getElementById('dob').value;
        document.getElementById('uphnum').innerText = document.getElementById('phnum').value;
        document.getElementById('uemail').innerText = document.getElementById('email').value;
        document.getElementById('ulocation').innerText = document.getElementById('city').value +", "+ document.getElementById('state').value;
        document.getElementById('dec_place').innerText = document.getElementById('city').value +", "+ document.getElementById('state').value;

        document.getElementById('uabout').innerText = document.getElementById('uaboutself').value;
        document.getElementById('ucareerobject').innerText = document.getElementById('ucareerob').value;

        document.getElementById('fathername').innerHTML = "Father's Name  <span style='margin-left:20px'></span>"+ ":" + document.getElementById('fname').value;
        document.getElementById('mothername').innerHTML = "Mother's Name   <span style='margin-left:20px'></span>"+":" + document.getElementById('mname').value;
        document.getElementById('permanentaddress').innerHTML = "Permanent Address    <span style='margin-left:20px'></span>"+":"+ document.getElementById('paddress').value;

        var myTab = document.getElementById('education_data');

        document.getElementById('education_data_table').innerHTML="";
        // LOOP THROUGH EACH ROW OF THE TABLE AFTER HEADER.
        for (i = 0; i < myTab.rows.length; i++) {
            // GET THE CELLS COLLECTION OF THE CURRENT ROW.
              var objCells = myTab.rows.item(i).cells;
            // LOOP THROUGH EACH CELL OF THE CURENT ROW TO READ CELL VALUES.
            data = "<tr><td><span style='font-weight: 600;font-size: 20px'>"+
                    objCells.item(0).innerHTML
                    +"</span> <br>"+objCells.item(1).innerHTML+"</td>"+
                    "<td>Graduated, "+objCells.item(2).innerHTML +" "+objCells.item(3).innerHTML+"</td></tr>";
           document.getElementById('education_data_table').innerHTML = document.getElementById('education_data_table').innerHTML + data;
        }

        var myTab = document.getElementById('acheivement_data');

        document.getElementById('achivements_data_li').innerHTML="";
        // LOOP THROUGH EACH ROW OF THE TABLE AFTER HEADER.
        for (i = 0; i < myTab.rows.length; i++) {
            // GET THE CELLS COLLECTION OF THE CURRENT ROW.
              var objCells = myTab.rows.item(i).cells;
            // LOOP THROUGH EACH CELL OF THE CURENT ROW TO READ CELL VALUES.
            
            data = "<li style='font-size:18px;margin-bottom: 5px'>"+
                    objCells.item(0).innerHTML + "</li>";
           document.getElementById('achivements_data_li').innerHTML = document.getElementById('achivements_data_li').innerHTML + data;
        }

        var myTab = document.getElementById('skill_data');

        document.getElementById('skills_data_li').innerHTML="";
        // LOOP THROUGH EACH ROW OF THE TABLE AFTER HEADER.
        for (i = 0; i < myTab.rows.length; i++) {
            // GET THE CELLS COLLECTION OF THE CURRENT ROW.
            var objCells = myTab.rows.item(i).cells;
            // LOOP THROUGH EACH CELL OF THE CURENT ROW TO READ CELL VALUES.
            
            data = "<li style='font-size:18px;margin-bottom: 5px'>"+
                    objCells.item(0).innerHTML + "</li>";
        document.getElementById('skills_data_li').innerHTML = document.getElementById('skills_data_li').innerHTML + data;
        }
        fetch('/get_achievements', {
  method: 'GET',
  headers: {
    'Content-Type': 'application/json'
  }
})
  .then(response => response.json())
  .then(data => {
    var achievementsDiv = document.getElementById('achievements');
    achievementsDiv.innerHTML = ''; // Clear the existing achievements data
    for (var i = 0; i < data.length; i++) {
      // Add each achievement as a new line in the achievementsDiv
      achievementsDiv.innerHTML += data[i].achievement + '<br>';
    }
  })
  .catch(error => {
    console.error('Error:', error);
  });
        
    }
    function addAchievementData() {
var achievement = document.getElementById('achivement').value;
if (achievement === '') {
  document.getElementById('achivement_err').style.display = '';
  document.getElementById('achivements').style.display = 'none';
} else {
  // Send an AJAX POST request to the Flask server to add the achievement
  fetch('/add_achievement', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      achievement: achievement
    })
  })
    .then(response => response.json())
    .then(data => {
      // Handle the response from the server
      console.log(data); // Use the response data as needed

      // Clear the input field and show success message
      document.getElementById('achivement').value = '';
      document.getElementById('achivement_err').style.display = 'none';
      document.getElementById('achivements').style.display = '';
      fetchData(); // Fetch and update achievements to display the new one
    })
    .catch(error => {
      // Handle any errors that occur during the AJAX request
      console.error('Error:', error);
    });
}
}

    function printDiv() 
        {
           $("#head").hide();
           window.print();
           $("#head").show();
        }


    function achivementDeleteFunction() {
        document.getElementById("acheivement_data").deleteRow(0);
    }

    function addskills(){
        if(document.getElementById('skills').value==""){
            document.getElementById('skills_err').style.display="";
        }
        else{
            var table = document.getElementById("skill_data");
            var row = table.insertRow(0);
            var cell1 = row.insertCell(0);
            cell1.innerHTML = document.getElementById('skills').value;
            }
    }
    function skillsDeleteFunction() {
        document.getElementById("skill_data").deleteRow(0);
    }

    function myDeleteFunction() {
        document.getElementById("education_data").deleteRow(0);
    }


function fetchData() {
    // Fetch education data from the server and update the table
    fetch('/get_education_data', {
        method: 'GET',
        headers: {
            'Content-Type': 'application/json'
        }
    })
    .then(response => response.json())
    .then(data => {
        // Update the table with the fetched data
        var table = document.getElementById('education_data');
        table.innerHTML = ''; // Clear the existing table data
        for (var i = 0; i < data.length; i++) {
            var row = table.insertRow();
            var cell1 = row.insertCell(0);
            var cell2 = row.insertCell(1);
            var cell3 = row.insertCell(2);
            var cell4 = row.insertCell(3);
            var cell5 = row.insertCell(4);

            cell1.innerHTML = data[i].course_name;
            cell2.innerHTML = data[i].cpi;
            cell3.innerHTML = data[i].college_name;
            cell4.innerHTML = data[i].graduation_month + ' ' + data[i].graduation_year;
            cell5.innerHTML = `<button onclick="deleteCourseData(${data[i].education_id})">Delete</button>`;
        }
    })
    .catch(error => {
        console.error('Error:', error);
    });
}
function deleteCourseData(educationId) {
// Send an AJAX POST request to the Flask server to delete the course
fetch('/delete_education', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    education_id: educationId
  })
})
  .then(response => response.json())
  .then(data => {
    // Handle the response from the server
    console.log(data); // Use the response data as needed
    // Fetch data again to update the table after deleting the course
    fetchData();
  })
  .catch(error => {
    // Handle any errors that occur during the AJAX request
    console.error('Error:', error);
  });
}
// Fetch education data and populate the table when the page loads
document.addEventListener('DOMContentLoaded', function() {
    fetchData();
});
function delEducationData() {
// Retrieve the form data
const formElement = document.querySelector('.needs-validation');
const formData = new FormData(formElement);

// Send an AJAX POST request to the Flask server
fetch('/delete_education', {
  method: 'POST',
  body: formData,
})
  .then(response => response.json())
  .then(data => {
    console.log(data); 
  })
  .catch(error => {
    // Handle any errors that occur during the AJAX request
    console.error('Error:', error);
  });
}
function addEducationData() {
// Retrieve the form data
const formElement = document.querySelector('.needs-validation');
const formData = new FormData(formElement);

// Send an AJAX POST request to the Flask server
fetch('/add_education', {
  method: 'POST',
  body: formData,
})
  .then(response => response.json())
  .then(data => {
    // Handle the response from the server
    if ("new_education_id" in data) {
      // Get the new_education_id from the response
      const newEducationId = data.new_education_id;

      // Use the newEducationId as needed (e.g., update the UI, etc.)
      console.log("Newly generated education_id:", newEducationId);

      // Call the fetchData function to update the table with the newly added record
      fetchData();
    } else {
      // Handle the error case, if any
      console.error("Error:", data.error);
    }
  })
  .catch(error => {
    // Handle any errors that occur during the AJAX request
    console.error('Error:', error);
  });
}

// Add an event listener to the "Add data" button
document.getElementById('addDataBtn').addEventListener('click', function (event) {
event.preventDefault(); // Prevent the default form submission behavior

// Call the addEducationData function when the button is clicked
addEducationData();
});
function addSkills() {
    const skillsValue = document.getElementById('skills').value;
    if (skillsValue.trim() === '') {
        document.getElementById('skills_err').style.display = '';
    } else {
        document.getElementById('skills_err').style.display = 'none';

        // Send the skills data to the Flask server for adding
        fetch('/add_skills', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded'
            },
            body: `skills=${encodeURIComponent(skillsValue)}`
        })
        .then(response => response.json())
        .then(data => {
            // Handle the response from the server
            console.log(data); // Use the response data as needed

            // If the skills were successfully added, update the table
            if (data === 'Skills added successfully') {
                var table = document.getElementById("skill_data");
                var row = table.insertRow(0);
                var cell1 = row.insertCell(0);
                cell1.innerHTML = skillsValue;
            }
        })
        .catch(error => {
            // Handle any errors that occur during the AJAX request
            console.error('Error:', error);
        });
    }
}

function deleteSkills() {
    const skillsValue = document.getElementById('skills').value;
    if (skillsValue.trim() === '') {
        document.getElementById('skills_err').style.display = '';
    } else {
        document.getElementById('skills_err').style.display = 'none';

        // Send the skills data to the Flask server for deleting
        fetch('/delete_skills', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded'
            },
            body: `skills=${encodeURIComponent(skillsValue)}`
        })
        .then(response => response.json())
        .then(data => {
            // Handle the response from the server
            console.log(data); // Use the response data as needed

            // If the skills were successfully deleted, update the table
            if (data === 'Skills deleted successfully') {
                var table = document.getElementById("skill_data");
                if (table.rows.length > 0) {
                    table.deleteRow(0);
                }
            }
        })
        .catch(error => {
            // Handle any errors that occur during the AJAX request
            console.error('Error:', error);
        });
    }
}
</script>
</body>
</html>
